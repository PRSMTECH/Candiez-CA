# Railway/Nixpacks build configuration
# Builds the Express server from the /server directory

[phases.setup]
nixPkgs = ["nodejs_20", "npm", "python3", "gcc", "gnumake"]

[phases.install]
cmds = [
  "cd server && npm ci --include=dev || npm install",
  "cd server && npm rebuild better-sqlite3 bcrypt"
]

[start]
cmd = "cd server && npm start"
